# 无证书使用指南

## 📦 应用构建

本应用采用 **Ad-hoc 签名**（无开发者证书），可直接分发使用。

---

## 🚀 安装步骤

### 1. 下载/复制应用
将 `YourApp.app` 复制到 `/Applications` 或任意文件夹

### 2. 首次运行（重要！）

#### 方法一：右键打开（推荐）
1. **右键点击** `YourApp.app`
2. 选择 **"打开"**
3. 弹出警告窗口，点击 **"打开"** 按钮
4. 首次运行成功后，之后可以直接双击打开

#### 方法二：命令行打开
```bash
open /Applications/YourApp.app
```

#### 方法三：系统设置允许
如果双击运行被阻止：
1. 打开 **"系统设置"** → **"隐私与安全性"**
2. 在 "安全性" 部分找到被阻止的应用提示
3. 点击 **"仍要打开"** 按钮
4. 再次右键打开应用，确认运行

---

## 🔑 权限授予（首次运行时）

### 1. 终端控制权限（必需）
**提示**: "YourApp 想要控制 Terminal"

**操作**: 点击 **"好"** 或 **"允许"**

**用途**: 用于打开终端窗口进行项目监控

**设置路径**: 
- 系统设置 → 隐私与安全性 → 自动化 → YourApp → 勾选 Terminal

### 2. 文件访问权限（可选）
**提示**: "YourApp 想要访问 Documents/Desktop 文件夹"

**操作**: 点击 **"好"** 或 **"允许"**

**用途**: 读取项目日志和配置文件

**设置路径**:
- 系统设置 → 隐私与安全性 → 文件和文件夹 → YourApp

### 3. 完全磁盘访问权限（可选但推荐）
**用途**: 监控所有项目进程和日志文件

**手动开启**:
1. 系统设置 → 隐私与安全性 → 完全磁盘访问权限
2. 点击 **"+"** 按钮
3. 选择 `YourApp.app`
4. 勾选启用

### 4. 管理员权限（按需）
**提示**: 部署或安装操作时弹出密码输入框

**操作**: 输入 **管理员密码**

**用途**: 执行 sudo 命令（如 Docker 安装）

---

## ⚠️ 常见问题

### Q1: "无法打开 YourApp，因为它来自身份不明的开发者"

**解决方案**:
```bash
# 方法1: 移除隔离标志
xattr -cr /Applications/YourApp.app

# 方法2: 右键 → 打开 → 点击"打开"按钮
```

### Q2: "YourApp 已损坏，无法打开"

**原因**: 下载或复制时被添加隔离标志

**解决方案**:
```bash
# 移除扩展属性
sudo xattr -cr /Applications/YourApp.app

# 重新 ad-hoc 签名
codesign --force --deep --sign - /Applications/YourApp.app
```

### Q3: 终端监控功能无法使用

**检查**:
1. 系统设置 → 隐私与安全性 → 自动化 → YourApp → 确认 Terminal 已勾选
2. 如果没有看到 YourApp，尝试重启应用

### Q4: 无法读取项目日志

**检查**:
1. 系统设置 → 隐私与安全性 → 完全磁盘访问权限
2. 确认 YourApp 已添加并勾选

### Q5: 每次运行都要输入管理员密码

**说明**: 这是正常行为，仅在执行需要 sudo 的操作时才会提示（如部署）

---

## 🔧 高级设置

### 允许任何来源的应用（macOS 10.12+）
```bash
# 查看当前状态
spctl --status

# 禁用 Gatekeeper（不推荐，安全风险）
sudo spctl --master-disable

# 启用 Gatekeeper
sudo spctl --master-enable
```

### 检查应用签名状态
```bash
codesign -dv /Applications/YourApp.app
```

### 检查隔离标志
```bash
xattr -l /Applications/YourApp.app
```

---

## 📋 权限清单

| 权限类型 | 必需性 | 用途 |
|---------|--------|------|
| 终端控制（AppleScript） | ✅ 必需 | 打开终端窗口监控 |
| 文件访问 | ⚠️ 推荐 | 读取项目日志 |
| 完全磁盘访问 | ⚠️ 推荐 | 监控所有项目 |
| 管理员权限 | 🔄 按需 | 部署/安装操作 |

---

## 🛠️ 卸载

1. **删除应用**:
   ```bash
   rm -rf /Applications/YourApp.app
   ```

2. **清理配置**（如果有）:
   ```bash
   rm -rf ~/Library/Application\ Support/YourApp
   rm -rf ~/Library/Preferences/com.yourapp.YourApp.plist
   ```

3. **移除权限授权**:
   - 系统设置 → 隐私与安全性 → 各项权限中手动移除

---

## 📞 技术支持

如遇到其他问题，请提供以下信息：

1. macOS 版本: `sw_vers`
2. 错误信息截图
3. 控制台日志:
   ```bash
   log show --predicate 'process == "YourApp"' --last 5m
   ```

---

## 🔐 安全说明

- 本应用使用 **Ad-hoc 签名**（自签名），非 Apple 官方签名
- 应用不会收集或上传任何用户数据
- 所有脚本从 GitHub 公开仓库下载，可审查源代码
- 管理员权限仅用于明确的系统操作（Docker 安装等）
- 建议仅安装来自可信源的应用

---

## ✅ 验证应用完整性

### 检查应用签名
```bash
codesign -dv --verbose=4 /Applications/YourApp.app
```

**预期输出**:
```
Executable=/Applications/YourApp.app/Contents/MacOS/YourApp
Identifier=com.yourapp.YourApp
Format=app bundle with Mach-O universal (x86_64 arm64)
Signature=adhoc
...
```

### 检查可执行文件
```bash
file /Applications/YourApp.app/Contents/MacOS/YourApp
```

**预期输出**:
```
Mach-O universal binary with 2 architectures:
- x86_64
- arm64
```

---

## 📝 更新日志

### v1.0.0 (2026-01-17)
- ✅ 初始版本发布
- ✅ 支持 Docker/Python/Node.js 项目管理
- ✅ 终端监控功能
- ✅ 批量操作支持
- ✅ 无证书 Ad-hoc 签名
